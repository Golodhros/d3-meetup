define(function(require){"use strict";var d3=require("d3");return function(){function exports(_selection){_selection.each(function(_data){chartWidth=width-margin.left-margin.right,chartHeight=height-margin.top-margin.bottom,data=_data,buildScales(),buildAxis(),buildSVG(this),drawBars(),drawAxis()})}function buildAxis(){xAxis=d3.svg.axis().scale(xScale).orient("bottom"),yAxis=d3.svg.axis().scale(yScale).orient("left").ticks(10,"%")}function buildContainerGroups(){var container=svg.append("g").classed("container-group",!0).attr({transform:"translate("+margin.left+","+margin.top+")"});container.append("g").classed("chart-group",!0),container.append("g").classed("x-axis-group axis",!0),container.append("g").classed("y-axis-group axis",!0)}function buildScales(){xScale=d3.scale.ordinal().domain(data.map(getLetter)).rangeRoundBands([0,chartWidth],.1),yScale=d3.scale.linear().domain([0,d3.max(data,getFrequency)]).range([chartHeight,0])}function buildSVG(container){svg||(svg=d3.select(container).append("svg").classed("bar-chart",!0),buildContainerGroups()),svg.transition().attr({width:width+margin.left+margin.right,height:height+margin.top+margin.bottom})}function drawAxis(){svg.select(".x-axis-group.axis").attr("transform","translate(0,"+chartHeight+")").call(xAxis),svg.select(".y-axis-group.axis").call(yAxis)}function drawBars(){var gapSize=xScale.rangeBand()/100*gap,barW=xScale.rangeBand()-gapSize,bars=svg.select(".chart-group").selectAll(".bar").data(data);bars.enter().append("rect").classed("bar",!0).attr({width:barW,x:chartWidth,y:function(d){return yScale(d.frequency)},height:function(d){return chartHeight-yScale(d.frequency)}}),bars.attr({width:barW,x:function(d){return xScale(d.letter)+gapSize/2},y:function(d){return yScale(d.frequency)},height:function(d){return chartHeight-yScale(d.frequency)}}),bars.exit().style({opacity:0}).remove()}var data,chartWidth,chartHeight,xScale,yScale,xAxis,yAxis,svg,margin={top:20,right:20,bottom:30,left:40},width=960,height=500,gap=2,getLetter=function(d){return d.letter},getFrequency=function(d){return d.frequency};return exports.margin=function(_x){return arguments.length?(margin=_x,this):margin},exports.width=function(_x){return arguments.length?(width=_x,this):width},exports.height=function(_x){return arguments.length?(height=_x,this):height},exports}});